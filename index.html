<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ESP32 Автоматика</title>
<style>
  body { font-family: Arial; background: #f0f0f5; text-align:center; }
  .header { background:#4a76a8; color:#fff; padding:20px; font-size:28px; margin-bottom:20px; }
  .card { width:320px; margin:10px auto; background:#fff; border-radius:12px; padding:20px; box-shadow:0 4px 10px rgba(0,0,0,0.1); }
  .value { font-size:32px; margin-bottom:10px; }
  input[type=number] { width:80px; padding:6px; font-size:18px; }
  .slider { width:90%; }
</style>
<script src="https://unpkg.com/mqtt/dist/mqtt.min.js"></script>
<script>
let client = mqtt.connect('ws://broker.hivemq.com:8000/mqtt');

client.on('connect', () => {
    console.log('MQTT Connected');
    client.subscribe('esp32/temps');
});

client.on('message', (topic, message) => {
    if(topic === 'esp32/temps') {
        let d = JSON.parse(message.toString());
        document.getElementById('t1').innerText = d.t1;
        document.getElementById('t2').innerText = d.t2;
        document.getElementById('t3').innerText = d.t3;
        document.getElementById('t4').innerText = d.t4;
    }
});

function sendSet(id){
    let val = document.getElementById('set'+id).value;
    client.publish('esp32/set'+id, val);
}

function sendPower(){
    let val = document.getElementById('powerRange').value;
    document.getElementById('powerVal').innerText = val;
    client.publish('esp32/power', val);
}
</script>
</head>
<body>
<div class="header">ESP32 Автоматика</div>

<div class="card">
  <h2>Температура 1</h2>
  <div class="value" id="t1">--</div>
  Уставка: <input type="number" id="set1" value="50" />°C
  <button onclick="sendSet(1)">OK</button>
</div>

<div class="card">
  <h2>Температура 2</h2>
  <div class="value" id="t2">--</div>
  Уставка: <input type="number" id="set2" value="50" />°C
  <button onclick="sendSet(2)">OK</button>
</div>

<div class="card">
  <h2>Температура 3</h2>
  <div class="value" id="t3">--</div>
  Уставка: <input type="number" id="set3" value="50" />°C
  <button onclick="sendSet(3)">OK</button>
</div>

<div class="card">
  <h2>Температура 4</h2>
  <div class="value" id="t4">--</div>
</div>

<div class="card">
  <h2>Потужність ТЕН (%)</h2>
  <div class="value" id="powerVal">0</div>
  <input type="range" min="0" max="100" value="0" class="slider" id="powerRange" oninput="sendPower()"/>
</div>

</body>
</html>
